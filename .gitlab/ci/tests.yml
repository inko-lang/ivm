---
test:windows:
  extends:
    - .only-source-repository
  tags:
    - shared-windows
    - windows
    - windows-1809
  stage: test
  before_script:
    - ./scripts/run.ps1 choco install rust-ms --yes
    - cargo --version
    - rustc --version
  script:
    - cargo test
  cache:
    key: windows
    paths:
      - .cargo
      - target

test:macos:
  extends:
    - .only-source-repository
  tags:
    - macos
    - inko
    - m1
  stage: test
  before_script:
    - cargo --version
    - rustc --version
  script:
    - cargo test
  cache:
    key: macos
    paths:
      - .cargo
      - target

test:linux:
  image: registry.gitlab.com/inko-lang/development-docker-images:alpine
  stage: test
  before_script:
    - cargo --version
    - rustc --version
  script:
    - cargo test
  cache:
    key: linux
    paths:
      - .cargo
      - target
