---
lint:cargo-deny:
  image: registry.gitlab.com/inko-lang/development-docker-images:cargo-deny
  stage: test
  before_script:
    - cargo --version
    - rustc --version
  script:
    - cargo deny check
  except:
    - tags

lint:clippy:
  image: registry.gitlab.com/inko-lang/development-docker-images:rust-stable
  stage: test
  before_script:
    - rustc --version
    - cargo --version
  script:
    - cargo clippy -- -D warnings
  cache:
    paths:
      - .cargo
      - target
  except:
    - tags

lint:rustfmt:
  image: registry.gitlab.com/inko-lang/development-docker-images:rust-stable
  stage: test
  before_script:
    - rustc --version
    - cargo --version
    - rustfmt --version
  script:
    - rustfmt --check src/main.rs
  except:
    - tags

lint:gitlint:
  image: registry.gitlab.com/inko-lang/development-docker-images:python
  stage: test
  before_script:
    - gitlint --version
  script:
    - gitlint --commits "HEAD~$((GIT_DEPTH - 1))..HEAD"
